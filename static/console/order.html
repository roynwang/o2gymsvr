<div class="col-md-12" ng-controller="OrderDetailCtrl as ctrl">
    <section class="panel">
        <header class="panel-heading">
            <h4 class="text-center">
<i ng-click="ctrl.gohome()" class="fa fa-arrow-circle-o-left pull-left" style="margin-left: 20px;font-size:30px; color:lightgrey"></i>
					<i ng-if="ctrl.order.customerdetail.flag==0"  style="color:#ccc" class="fa fa-circle-o"></i>
					<i ng-if="ctrl.order.customerdetail.flag==1"  style="color:#a9d86e" class="fa fa-circle"></i>
					<i ng-if="ctrl.order.customerdetail.flag==2"  style="color:#FCB322" class="fa fa-circle"></i>
				{{ctrl.order.customerdetail.displayname}}
                <ul class="nav nav-tabs pull-right" style="position: relative;
					    bottom: -21px;right: 20px;">
                    <li class="panel-header-tab {{ctrl.activetab[0]?'active':''}}">
                        <a class="btn btn-pirmary" ng-click="ctrl.toggle(0)" aria-expanded="true">约课</a>
                    </li>
                    <li class="panel-header-tab {{ctrl.activetab[1]?'active':''}}">
                        <a ng-click="ctrl.toggle(1)" aria-expanded="false">照片</a>
                    </li>
                    <li class="panel-header-tab {{ctrl.activetab[2]?'active':''}}">
                        <a ng-click="ctrl.toggle(2)" aria-expanded="false">数据</a>
                    </li>
                    <li class="panel-header-tab {{ctrl.activetab[3]?'active':''}}">
                        <a ng-click="ctrl.toggle(3)" aria-expanded="false">问卷</a>
                    </li>
                    <!--
                    <li class="{{ctrl.activetab[2]?'active':''}}">
                        <a ng-click="ctrl.toggle(2)" aria-expanded="false">今日消费</a>
                    </li>
					-->
                </ul>

</h4>

        </header>
        <div class="panel-body" ng-show="ctrl.activetab[3]">
            <div  ng-click="ctrl.showques('new')" style="
border: 5px dashed #1fb5ad;
    width: 160px;
    height: 80px;
    line-height: 70px;
    border-radius: 3px;
    text-align: center;
    text-transform: uppercase;
	margin-right: 10px;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    color: #7f858a;
    display: inline-block;
	position: relative;
	margin-bottom: 10px;">
                    +添加
                </div>
            <div ng-repeat="eval in ctrl.ques" style="
	border: 5px dashed #7f858a;
    width: 160px;
    height: 80px;
    line-height: 70px;
    border-radius: 3px;
    text-align: center;
    text-transform: uppercase;
	margin-right: 10px;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    color: #7f858a;
    display: inline-block;
	position: relative;
	margin-bottom: 10px;" ng-click="ctrl.showques(eval.date)">
				{{eval.date}}
                </div>
			<!--
            <table ng-table="demo.tableParams" class="table table-condensed table-striped">
                <tr ng-repeat="row in $data">
                    <td data-title="'单价'">{{row.price}}</td>
                </tr>
            </table>
			-->
        </div>

        <div class="panel-body" ng-show="ctrl.activetab[2]">
            <div  ng-click="ctrl.showeval('new')" style="
border: 5px dashed #1fb5ad;
    width: 160px;
    height: 80px;
    line-height: 70px;
    border-radius: 3px;
    text-align: center;
    text-transform: uppercase;
	margin-right: 10px;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    color: #7f858a;
    display: inline-block;
	position: relative;
	margin-bottom: 10px;">
                    +添加
                </div>
            <div ng-repeat="eval in ctrl.evals" style="
	border: 5px dashed #7f858a;
    width: 160px;
    height: 80px;
    line-height: 70px;
    border-radius: 3px;
    text-align: center;
    text-transform: uppercase;
	margin-right: 10px;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    color: #7f858a;
    display: inline-block;
	position: relative;
	margin-bottom: 10px;" ng-click="ctrl.showeval(eval.date)">
				{{eval.date}}
                </div>
			<!--
            <table ng-table="demo.tableParams" class="table table-condensed table-striped">
                <tr ng-repeat="row in $data">
                    <td data-title="'单价'">{{row.price}}</td>
                </tr>
            </table>
			-->
        </div>

        <div class="panel-body" ng-show="ctrl.activetab[1]">
			<p>
            <div  ng-file-select="ctrl.addphoto($files)" style="
border: 5px dashed #1fb5ad;
    width: 190px;
    height: 190px;
    line-height: 180px;
    border-radius: 3px;
    text-align: center;
    text-transform: uppercase;
	margin-right: 10px;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    color: #7f858a;
    display: inline-block;
	position: relative;
	margin-bottom: 10px;">
                    +添加
                </div>
			<img ng-click="ctrl.openLightboxModal($index)" ng-repeat="img in ctrl.album"
			src="{{img.url}}?imageView2/1/w/200/h/200" style="margin-bottom:10px;margin-right:20px;width:180px">
            <div style="
border: 5px dashed #1fb5ad;
    width: 190px;
    height: 190px;
    line-height: 180px;
    border-radius: 3px;
    text-align: center;
    text-transform: uppercase;
	margin-right: 10px;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    color: #7f858a;
    display: inline-block;
	position: relative;
	margin-bottom: 10px;" ng-show="ctrl.loadmore" ng-click="ctrl.refreshPhoto()">
                    加载更多
                </div>

			</p>
			<!--
            <table ng-table="demo.tableParams" class="table table-condensed table-striped">
                <tr ng-repeat="row in $data">
                    <td data-title="'单价'">{{row.price}}</td>
                </tr>
            </table>
			-->
        </div>
        <div class="form-group panel-body" ng-show="ctrl.activetab[0]">
            <div class="row" style="margin-bottom:20px">
                <h3 class="text-center">
					<img ng-src="{{ctrl.coach.avatar}}?imageView2/1/w/200/h/200" style="-webkit-border-radius: 50%;
					height: 60px;"> {{ctrl.coach.displayname}} 
					<a style="font-size:12px;color:#999"
						ng-click="ctrl.showncoaches=!ctrl.showncoaches"><i class="fa
							fa-exchange"></i>{{ctrl.showncoaches?"收起":"更换"}}</a></h3>
            </div>
            <div ng-show="ctrl.showncoaches" class="row" style="margin-bottom:20px;padding-left:20px;padding-right:20px">
                <div style="padding-top:10px" class="col-sm-1 {{c.name==ctrl.coach.name?'coach-selected':''}}"
                ng-repeat="c in ctrl.gym.coaches_set" ng-click="ctrl.changecoach(c)">
                    <img ng-src="{{c.avatar}}" style="-webkit-border-radius: 50%;height: 50px;">
                    <p>{{c.displayname}}</p>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12" ng-model="ctrl.booked">
                    <p>过期时间:{{ctrl.order.endtime}}</p>
                    <p>课程状态(已上:{{ctrl.done.length}}/待上:{{ctrl.booked.length}}/待约{{ctrl.sum
                        - ctrl.booked.length - ctrl.done.length}})</p>
                    <div class="progress progress-sm">
                        <div class="progress-bar " style="width: {{ctrl.done.length/ctrl.sum*100}}%">
                            <span class="sr-only">35% Complete (success)</span>
                        </div>
                        <div class="progress-bar pending" style="width: {{ctrl.booked.length/ctrl.sum*100}}%">
                            <span class="sr-only">20% Complete (warning)</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-7 col-sm-12">
                    <table class="table " ng-table="ctrl.tableParams">
                        <tr ng-repeat="row in $data | filter:ctrl.bookvisiable">
                            <td data-title="''">
                                <i ng-if="ctrl.role == 'admin' || !row.done" class="fa fa-times" ng-click="ctrl.cancelbook(row)"
                                style="cursor:pointer;color:#666"></i>
                                <i ng-if="ctrl.role !='admin' && row.done" class="fa fa-times" style="visibility:hidden;cursor:pointer;color:#666"></i>
                            </td>
                            <td data-title="'教练'">{{row.coachprofile.displayname||row.coachname}}</td>
                            <td data-title="'日期'">{{row.date}}</td>
                            <td data-title="'时间'">{{timemap[row.hour]}}</td>
                            <!--
                            <td data-title="'状态'"><span class="label label-mini
								{{row.done?'label-primary':'label-success'}}">{{row.done?"已完成":"待上课"}}</span>
                            </td>
							-->
                            <td data-title="'操作'">
                                <button class="btn btn-primary btn-xs" ng-show="!row.done && (row.id !=
									undefined)" ng-click="ctrl.bookComplete(row)">&nbsp;完成</button>
                                <button class="btn btn-default btn-xs" ng-show="row.done"><i class="fa fa-check-square-o"></i>&nbsp;已上</button>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="col-md-5 col-sm-12">
                    <newdatepicker button-prev="<i class='fa fa-arrow-left'></i>" button-next="<i
						class='fa fa-arrow-right'></i>" date-format="yyyy-MM-dd" selector="form-control"
                    style="margin-bottom:10px;margin-top:10px">
                        <div class="col-lg-12 input-group">
                            <input class="form-control" style="background: rgba(0,0,0,0);" ng-model="ctrl.day_str"
                            ng-change="ctrl.refreshtimetable(false)" placeholder="Choose a date"
                            />
                        </div>
                        <span style="cursor: pointer;position: absolute;top: 6px;right: 20px;" style="cursor: pointer">
							<i class="fa fa-lg fa-calendar"></i>
						</span>
                    </newdatepicker>
                    <table class="table table-bordered" ng-model="ctrl.day" style="margin-top:10px">
                        <tr ng-repeat="row in ctrl.timemapgroup">
                            <td ng-repeat-start="i in [0,1,2,3,4]" ng-repeat-end class="{{row[i]['status']?'bg-lightgrey':''}}"
                            style="border-color: #f1f1f1;" ng-click="ctrl.book(row[i]['id'])">
                                {{timemap[row[i]["id"]]}}
                            </td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="row">
                <p class="text-center"><a ng-hide="ctrl.status=='done'" class="btn btn-primary btn-lg text-center" style="margin-top:20px"
                    ladda="that.submitting" data-style="expand-left" ng-click="ctrl.submitBook()">保存</a>
                </p>
            </div>
        </div>


    </section>
</div>
